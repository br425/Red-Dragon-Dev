<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale=1.0, width=device-width">

	<title>The Red Dragon Voyage</title>

	<link rel="stylesheet" href="css/main-styles.css">
	<link rel="stylesheet" href="css/anims.css">
	<link rel="stylesheet" href="css/normalize.css">
	<script src='https://api.mapbox.com/mapbox-gl-js/v0.42.0/mapbox-gl.js'></script>
	<link href='https://api.mapbox.com/mapbox-gl-js/v0.42.0/mapbox-gl.css' rel='stylesheet' />

    <style>
    	body{margin:0; padding:0;}#map{position:absolute; top:0; bottom:-30px; width:100%;}
    </style>

</head>
<body id="voyageBody"><!-- onload="drawMap('regularBG')" -->
    <style>#map{position:fixed;width:100%;z-index: -10;}</style>


<!-- BACKGROUND EFFECTS -->

<div id="paperBG" class="imgBG"></div>
<div id="redBG" class="imgBG"></div>
<div id="rain" class="imgBG"></div>

<!-- PARALLAX BGs -->
<div id="bannerBG" class="imgBG"></div>
<div id="sierraLeoneParBG" class="imgBG"></div>
<div id="sierraLeoneParFG" class="imgBG"></div>

<div id="rioDeLaPlataParBG" class="imgBG"></div>
<div id="rioDeLaPlataParFG" class="imgBG"></div>

<div id="salvadorParBG" class="imgBG"></div>
<!-- <div id="salvadorParMG" class="imgBG"></div> -->
<div id="salvadorParFG" class="imgsidebarBG"></div>

<div id='map'></div>

<div id="debug" style="display: none;"></div>
<div id="loading"><img src="icons/loading.gif" alt="Loading..."></div>
<div id="continue"><p>Scroll to Continue</p></div>





	<aside id="voyageNav">
		<div id="mobileHeader">
		<div id="compassButton"></div>
		<a href="index.html" id="voyageNavA">
			<!-- <img src="icons/logo-white.svg" alt="Logo" id="voyageLogo"> -->
			<!-- <img src="icons/title-logo.svg" alt="Title" id="voyageTitle"> -->
			<img src="icons/reddragon_white-03.png" alt="Title" id="voyageTitle">
			<!-- <h1 class="voyageLogo">The Red Dragon</h1> -->
		</a>
		</div>
		<div class="barContainer">
		<div id="sideBar">
				<a href="#england" onclick="reloadTrips(1);" id="one"><span class="dot"><span>-</span>x</span><span class="title">England</span></a>
				<a href="#fuerteventura" onclick="reloadTrips(3);" id="two"><span class="dot"><span>-</span>x</span><span class="title">Fuerteventura</span></a>
				<a href="#rioDeOro" onclick="reloadTrips(5);" id="three"><span class="dot"><span>-</span>x</span><span class="title">Rio de Oro</span></a>
				<a href="#sierraLeone" onclick="reloadTrips(7);" id="four"><span class="dot"><span>-</span>x</span><span class="title">Sierra Leone</span></a>
				<a href="#rioDeLaPlata" onclick="reloadTrips(9);" id="five"><span class="dot"><span>-</span>x</span><span class="title">Rio De La Plata</span></a>
				<a href="#islaDeLobos" onclick="reloadTrips(11);" id="six"><span class="dot"><span>-</span>x</span><span class="title">Isle de Lobos</span></a>
				<a href="#salvador" onclick="reloadTrips(13);" id="seven"><span class="dot"><span>-</span>x</span><span class="title">Salvador</span></a>
				<a href="#capeVerde" onclick="reloadTrips(15);" id="eight"><span class="dot"><span>-</span>x</span><span class="title">Cape Verde</span></a>
				<a href="#southampton" onclick="reloadTrips(17);" id="nine"><span class="dot"><span>-</span>x</span><span class="title">Southampton</span></a>
		</div>
		</div>
	</aside>


<main id="content">

<div id="locationBox">
	<h2 class="locationTitle" id="englandTitle" style="transition: 1s;">England</h2>
	<h2 class="locationTitle" id="fuerteventuraTitle" style="transition: 1s;">Fuerteventura</h2>
	<h2 class="locationTitle" id="rioDeOroTitle" style="transition: 1s;">Rio De Oro</h2>
	<h2 class="locationTitle" id="islaDeLobosTitle" style="transition: 1s;">Isle De Lobos</h2>
	<h2 class="locationTitle" id="capeVerdeTitle" style="transition: 1s;">Cape Verde</h2>
	<h2 class="locationTitle" id="southamptonTitle" style="transition: 1s;">Southampton</h2>
</div>


<div id="titleCard" class="spacer100 spaceCenter">
	<h1 id="titleH">The Voyage of The Red Dragon</h1>
	<img src="icons/swirl.svg" alt="swirl" style="width: 30rem;">
	<!-- <p class="scrollPrompt">Start Scrolling to Begin</p> -->
</div>

		<section id="departure">
			<div class="spacer100"></div>
			<div class="spacer100"></div>

			<div class="spaceCenter">

				<div id="preludeText" class="anyText textBox blackTextBox">
						<img src="icons/boxTopBlack.svg" alt="Sidenav Icon">
					<div class="a">
						<h2>Prelude</h2>
						<!-- <img src="icons/rightArrow.svg" alt="Arrow"> -->
					</div>
					<div class="textArea">
						<p><img class="png" src="imgs/crest-1.png" alt="Crest of the Earl of Cumberland"></p>
						<p>
	The Voyage of the Red Dragon is a look into the life of the lives of Privateers in the Sixteenth Century. Here we follow the account of Thomas Hood, the pilot of the lead ship the Red Dragon, as well as the accounts of those both on the journey and those affected by its ravages. Join the voyage of The Red Dragon.
						</p>
					</div>
<!-- 					<a href="">
						<h2>Preamble</h2>
						<img src="icons/rightArrow.svg" alt="Arrow">
					</a>
 -->						
 							<img class="boxBottom" src="icons/boxTopBlack.svg" alt="Sidenav Icon">
				</div>
			</div>

		</section>




		<section id="england">
			<div class="spacer100"></div>
			<div class="spacer100"></div>

			<div class="spaceRight">
				<div id="departureText" class="anyText textBox redTextBox">
					<img class="boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
					<a href="http://www.scg52.com/Archive/?category=england/">
						<h2>License to Piracy</h2>
						<!-- <h2>License to Piracy</h2> -->
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrowIn.svg" alt="Arrow">
						</span>
					</a>
					<div class="textArea">
						<p><img src="imgs/england.png" alt="Map of England"></p>
						<p>
The Red Dragon expedition was backed by the Earle of Cumberland with the blessing of Queen Elizabeth and the letter of Marque from Dom Antonio, the rival pretender to the Portuguese throne. They left Gravesend England on June 24, 1586 with four ships. Robert Wirthington led the voyage with the main pilot of the lead ship being Thomas Hood. Their goal was to sail to the strait of Magellan to the pacific in search of plunder from Spanish ships. The voyage took around thirteen months from fall 1586 to summer 1587.
						</p>
					</div>
<!-- 					<a href="">
						<h2>Departing England</h2>
						<img src="icons/rightArrow.svg" alt="Arrow">
					</a>
 -->					
 					<img class="boxBottom boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
				</div>
			</div>
			<div id="englandTrans"></div>

		</section>


			<div id="toFuerteventura" class="spacer100"></div>


		<section id="fuerteventura">
			<div class="spacer100"></div>
			<div class="spacer100"></div>

			<div class=" spaceRight">

				<div id="fuerteventuraText" class="anyText textBox redTextBox">
					<img class="boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
					<a href="http://www.scg52.com/Archive/?category=fuerteventura">
						<h2>The Sack of Lanzarote</h2>
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrowIn.svg" alt="Arrow">
						</span>
					</a>
					<div class="textArea">
						<p><img src="imgs/fuerteventura.png" alt="Battle of Lanzarote"></p>
						<p>
	In the beginning, the Red Dragon stayed to the coast of Africa to search for basic supplies for the voyage. On the way to the island of Fuerteventura, the Red Dragon searched for canters, which was a bastardization of Canteras or Spanish fishing vessels. When they landed at Fuerteventura they had found that the Moors had sacked a nearby island called Lanzarote merely a month before. This kept all the citizens and officials on guard of new ships. Following this news the Red Dragon set sail not wishing to be caught by Spanish officials.
						</p>
						<!-- <p><img src="i" alt=""></p> -->
					</div>
<!-- 					<a href="">
						<h2>The Sack of Lanzarote</h2>
						<img src="icons/rightArrow.svg" alt="Arrow">
					</a>
 -->					
 					<img class="boxBottom boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
				</div>
			</div>
			<div id="fuerteventuraTrans"></div>
		</section>



			<div id="toRioDeOro" class="spacer100"></div>

		<section id="rioDeOro">

			<div class="spacer100"></div>
			<div class="spacer100"></div>
			<div class=" spaceRight">

				<div id="rioDeOroText" class="anyText textBox redTextBox">
					<img class="boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
					<a href="http://www.scg52.com/Archive/?category=rio-de-la-plata">
						<h2>The Saharan Coast</h2>
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrowIn.svg" alt="Arrow">
						</span>
					</a>
					<div class="textArea">
						<p><img src="imgs/rio-de-oro.jpg" alt="Rio De Oro"></p>
						<p>
							The voyage then continued to the Rio De Oro coast of west Africa. They sought fishing vessels there as this was a popular migration spot of sardines. The Red Dragon disembarked on the Saharan coast near the Canarie Islands and were greeted by two individuals. The men were presumably Berber fishermen and “cam down wyth a flag of trus.” The captain then spoke at length with one of them and brought a small crew of men who all fished with the man. From the man they learned that there were no supplies to be had except from what the Moors bring to trade with.
						</p>
					</div>
					<img class="boxBottom boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
				</div>
			</div>
			<div id="rioDeOroTrans"></div>


		</section>


		<div id="toSierraLeone" class="spacer100"></div>

		<section id="sierraLeone">

			<div class="spacer100"></div>
			<div class="spacer100 spaceCenter bigTitleBG">
				<h2 class="bigTitle anyText" id="sierraLeoneTitle" style="transition: 1s;">Sierra Leone</h2>
			</div>
			<div class="spacer50"></div>

			<div class="spacer100 spaceRight">
				<div id="sierraLeoneText" class="anyText bigStopText">

					<a href="http://www.scg52.com/Archive/?category=sierra-leone">
						<h2>Slaughter At the Watering Place</h2>
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrow.svg" alt="Arrow">
						</span>
					</a>
					<p>
						After stopping at the Saharan coast the Red Dragon then moved on to Sierra Leone as Thomas Hood and others had been to the area on previous voyages. Here they would stop for the “watering place” to acquire supplies for their voyage. Previously voyages had been allowed to gather resources from the area if they presented a tribute of wine to the leader of the Zapes. Zape is actually an umbrella term for several tribes in the area but had been brought under the rule of the Manes. Unbeknownst to the crew of the voyage there had been a voyage a few weeks previous led by Thomas Cavendish. The meeting of Cavendish and the Zapes was quick and violent as Cavendish’s men, through the knowledge of a detained Portuguese man, looted and burned a Zape village. This led the Zape people to strike back against Cavendish’s men.
					</p>
					<p>
						Cavendish’s initial attack had spoiled the goodwill between the Europeans and the Zapes. Six weeks after the skirmishes between the two parties the Red Dragon landed at the watering place. The Zapes had prepared by reinforcing the area and demanded a tribute of wine and clothes rather than just wine. Not expecting the higher demands and believing that they were being treated unfairly Negotiations broke down. After that the Red Dragon moored in the watering place and then skirmished with the local Zapes. After beating back the Zapes they then cleared the trees surrounding the area as both a defensive strategy and a source of timber. The next few days were marked by a quiet tension as the Red Dragon collected supplies of freshwater, fish, timber, and even a crocodile. The gathering of supplies without consent was a major act of provocation.
					</p>
					<p id="sierraLeoneText2">
						The next portion is marked by extreme violence and a ominously easy tone of the narrator Thomas Hood. Hood mentions the act of bringing a woman on board while the captain was away, presumably non-consensually. The days following were mixes of gathering resources and acts of large scale atrocities. The first of which being the captain bringing one hundred and fifty men ashore to pillage rice and burn the Zape village. They returned the next day to burn the rest of the houses.
					</p>
			</div>
			</div>


			<div id="sierraLeoneTrans"></div>
			<div class="spacer100"></div>

		</section>

		<!-- <div class="spacer10"></div> -->

		<div id="toRioDeLaPlata" class="spacer100"></div>


		<section id="rioDeLaPlata">

			<div class="spacer100"></div>
			<div class="spacer100 spaceCenter">
				<h2 class="bigTitle anyText" id="rioDeLaPlataTitle" style="transition: 1s;">Rio De La Plata</h2>
			</div>

			<div class="spacer50"></div>


			<div class="spacer100 spaceRight">
				<div id="rioDeLaPlataText" class="anyText bigStopText">

					<a href="http://www.scg52.com/Archive/?category=rio-de-la-plata">
						<h2>The Three Slavers</h2>
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrow.svg" alt="Arrow">
						</span>
					</a>
<p>
	After the sack of Sierra Leone the Red Dragon crossed the Atlantic to south America in search of the strait of Magellan. It was December when Hood steered them down the coast of South America. They were now in the Rio de la Plata. In January they reported seeing a sail in the distance. The next day this became two sails, two slaving ships of three on their way to Buenos Aires. These ships were tasked by the Bishop of Tucumán to bring forced labour, evangelizing priests, and material to build sugar mills and churches. The bishop had largely been accused of being less interested in faith and more so in business.
</p>
<p>
	Notable members on the slaving ships include merchants such as Diego de Palma and Lopo Vaz Pestana as well as the clergyman friar Francisco Salzedo. The slavers held what was a large capacity of slaves at the time, totaling one hundred and twenty slaves between all of three ships. Two of the slave ships were captured by the Red Dragon and consisted of many Spaniards, Portuguese, and around eighty slaves. After taking on so many new mouths to feed the Red Dragon was running into more serious issues of provisioning. Hood then suggested they stop by a place he called “sell eyland [seal island].”
</p>
</div>
			</div>

			<div id="rioDeLaPlataTrans"></div>

			<div class="spacer100"></div>

		</section>

		<div id="toIslaDeLobos" class="spacer100"></div>

		<section id="islaDeLobos">


			<div class="spacer100"></div>
			<div class="spacer100"></div>
			<div class="spaceRight">
				<div id="islaDeLobosText" class="anyText textBox redTextBox">
					<img class="boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
					<a href="http://www.scg52.com/Archive/?category=isla-de-lobos">
						<h2>Two Islands and the Coast</h2>
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrowIn.svg" alt="Arrow">
						</span>
					</a>
					<div class="textArea">
						<p>
							They then stopped on the Isla de Lobos a small island off the coast of present day Uruguay which sat at the cusp of the Rio de la Plata. The Red Dragon thus spent the next three days hunting seals, gathering provisions on another island which they referred to as Green Island, otherwise known as Isla de Gorriti, and on the shore of Punta del Este. After the hunting spree the crew decided it would be best to dump the sugar they had pillaged from the slavers in favor of the seal carcasses which would feed the enlarged population. They briskly hurried toward the strait of Magellan to find a Spanish port in which to sell the slaves.
						</p>
						<p><img src="imgs/isledelobos-1.jpg" alt="Picture of Isle De Lobos"></p>
						<p>
							While the Red Dragon sailed for the strait of Magellan it was becoming obvious they may not make it in time before winter came. Apparently even though the English did not speak much with their Spanish captives, the Portuguese were willing to talk. One of the Portuguese is even mentioned as having the idea of turning back to Brazil before winter began. Not having come to a consensus on what to do they could agree that they did not have enough to provisions to provide for everyone. They then decided to strip the slave ships of parts and leave around one hundred captives stranded thirty leagues from the shore. Testimonials of the encounter do not say what befell those stranded by the voyage but there were a handful of survivors who recounted an attack by the corsair “Roberto.” Eventually the crew came to the final decision of turning back to Brazil in late February when conditions started becoming too hazardous to continue.

						</p>
					</div>
					<img class="boxBottom boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
					<div class="spacer100"></div>
				</div>
			</div>

			<div id="islaDeLobosTrans"></div>
		</section>


		<div id="toSalvador" class="spacer100"></div>

		<section id="salvador">
			<div class="spacer100"></div>
			<div class="spacer100 spaceCenter">
				<h2 class="bigTitle anyText" id="salvadorTitle" style="transition: 1s;">Salvador</h2>
			</div>
			<div class="spacer50"></div>


			<div class="spacer100 spaceRight">
				<div id="salvadorText" class="anyText bigStopText">

					<a href="http://www.scg52.com/Archive/?category=salvador">
						<h2>War for the Colony</h2>
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrow.svg" alt="Arrow">
						</span>
					</a>
					<p>
						On the journey up the coast the fleet constantly disbanded and rebanded as tensions ran high. Provisions were growing low. At the end of March a couple mariners died of malnutrition. Eventually the fleet found an island near the Camamu river which they were able to restock on many provisions such as water, fruit, beef, chicken, etc. Even Hood who was largely secular praised God for the find. After poaching the provisions the Red Dragon found that Salvador had closed its doors upon the arrival of the English fleet. There the fleet met a pair of hulks from Flushing who had arrived to trade with the Portuguese but instead agreed to fight alongside the Red Dragon. The British then picked off many ships in the bay and took others captive. One of the few Portuguese prisoners the Red Dragon had not abandoned, Lopo Vaz Pestana, then escaped and swam to Salvador. Salvador, now expecting an imminent attack, gathered a local militia as the fortress guarding the bay only accounted for thirty soldiers. Vaz then went on to lead around thirty men himself to take back a smaller ship taken by the fleet which had drifted too far from them.
					</p>
					<p>
						In the next week the Red Dragon moved with relative ease burning plantations, stealing livestock, and gathering provisions while Salvador raised enough men to combat them. They were able to muster between two hundred and three hundred men who filled a small galleon and four smaller ships. The British had set up at the mouth of the Paraguaçu River where they gathered fresh water and took over several buildings. Here would be the site of fighting between large groups of English and parts of the Salvador militia. Here the natives joined Salvador in fending off the invading pirates. Here Hood takes a break from journaling the days of the voyage, assumably while in combat, so most of the information of the battles are recorded by the merchant Saracoll. Most of the conflict took part from the gathering of provisions as the crew was ambushed attempting to restock.
					</p>
					<p>
						One major battle happened on the island of Itaparica when the crew attempted to steal cattle and were met by a group of one hundred and fifty natives and Portuguese. Through heavy losses they were still able to claim seventeen bullocks. The fighting continued through May in the bay of all Saints. The English were being starved by the Luso-Indigenous strategies which included hiding any food stuffs and cattle in places where the Red Dragon appeared. This was especially troublesome as the privateers were easily read in their conquest of beef. The attacks ended as the Red Dragon negotiated with Salvador to return the captured men, as well as the sinking of the Dorothy. The fleet then shed some of the ships in worse condition and sailed back for England.
					</p>
				</div>
			</div>


			<div id="salvadorTrans"></div>
			<div class="spacer100"></div>


		</section>


		<div id="toCapeVerde" class="spacer100"></div>

		<section id="capeVerde">


			<div class="spacer100"></div>

			<div class="spacer100"></div>
			<div class="spacer100"></div>

			<div id="capeVerdeTrans"></div>

		</section>

		<div id="toSouthampton" class="spacer100"></div>
		<section id="southampton">


			<div class="spacer100"></div>
			<div class="spacer100"></div>
			<div class=" spaceRight">

				<div id="southamptonText" class="anyText textBox redTextBox">
					<img class="boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
					<a href="http://www.scg52.com/Archive/?category=england/">
						<h2>The Return</h2>
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrowIn.svg" alt="Arrow">
						</span>
					</a>
					<div class="textArea">
						<p><img src="imgs/rio-de-oro.jpg" alt="Rio De Oro"></p>
						<p>
							Their return voyage was a disaster. Wirthington had decided they should sail back to Cape Verde rather than ride the Gulf Stream to England. The pilots of the voyage made miscalculations and missed their mark adding two months to the voyage. Hood requited his anger at the captain for this decision. The fleet limped back to the Southampton harbor in September with little to show for their thirteen months at sea, likely with half the crew they departed with.
						</p>
					</div>
					<img class="boxBottom boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
				</div>
			</div>
			<div class="spacer100"></div>
			<div id="southamptonTrans"></div>

		</section>

		<div id="toEnding" class="spacer100"></div>

		<section id="ending">

			<div class="spacer50"></div>
			<div class="spacer50 spaceCenter">
				<div id="postludeText" class="anyText textBox redTextBox">
					<img class="boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
					<a href="http://www.scg52.com/Archive/">
						<h2>The Journey Goes Deeper</h2>
						<span class="flexRow ">
							<h4>Archive</h4>
							<img src="icons/rightArrow.svg" alt="Arrow">
						</span>
					</a>
					<div class="textArea">
						<p>
							Thank you for joining us on the Voyage of the Red Dragon!
						</p>
						<p>
							If you are interested in reading more about this crew and their exploits, please explore the archives for more information on each leg of the journey, as well as maps, manuscripts, and much more.
						</p>
					</div>
					<img class="boxBottom boxTop" src="icons/boxTop.svg" alt="Sidenav Icon">
				</div>

			</div>
			<div class="spacer50"></div>

			<div id="credits" class="credits anyText spacer100 spaceCenter">
						<div class="a">
							<h2>Contributors</h2>
						</div>

						<div class="flexRow textArea">
							<span>
								<h3>Researchers</h3>
								<p>Gabriel Rocha</p>
								<p>Maggie McNulty</p>
								<p></p>
								<p></p>
							</span>
							<span>
								<h3>Artists</h3>
								<p>Marissa Fu</p>
								<p>Kaci Kwiatek</p>
								<p></p>
								<p></p>
							</span>
							<span>
								<h3>Developers</h3>
								<p>Ben Rodia</p>
								<p>Axel Mortimer</p>
								<p>Stephen Gross</p>
								<p>Su Hnin Pwint</p>
							</span>
						</div>

			</div>
		</section>


	<!-- <footer></footer> -->

	</main>


	<script src="js/jquery-min.js"></script>
	<script src="js/generalScripts.js"></script>
	<script src="js/ScrollMagic.min.js"></script>
	<script src="js/TweenLite.min.js"></script>
	<script src="js/plugins/animation.gsap.js"></script>
	<script src="js/plugins/CSSPlugin.min.js"></script>
	<script src="js/voyageScrolls.js"></script>

<script>

  mapboxgl.accessToken = 'pk.eyJ1IjoiYXhvbmFsdCIsImEiOiJjajh1bXU0ajcxMjY2MzNwOGJvaHN0bDBjIn0.oUvMV9_vKdrLQExQnzMTXQ';
  var map = new mapboxgl.Map({
  		container: 'map',
      style: 'mapbox://styles/axonalt/cjczcjckx0h9x2sqwwjab2iiy',
      interactive: false,
      bearing: 0,
      center: [-39.971008, 19.642588],
      zoom: 2,
      pitch: 0
  });
	// Create a GeoJSON source with an empty lineString.
	var geojsonLine = {
			'fuerteventura': {
					"type": "FeatureCollection",
			    "features": [{
			        "type": "Feature",
			        "geometry": {
			            "type": "LineString",
			            "coordinates": [[0.372266, 51.445877]]
			        }
			    }]
			},
			'rioDeOro': {
					"type": "FeatureCollection",
					"features": [{
							"type": "Feature",
							"geometry": {
									"type": "LineString",
									"coordinates": [[-13.866186, 28.484082]]
							}
					}]
			},
			'sierraLeone': {
					"type": "FeatureCollection",
					"features": [{
							"type": "Feature",
							"geometry": {
									"type": "LineString",
									"coordinates": [[-15.796667, 23.711389]]
							}
					}]
			},
			'rioDeLaPlata':{
					"type": "FeatureCollection",
					"features": [{
							"type": "Feature",
							"geometry": {
									"type": "LineString",
									"coordinates": [[-13.0289, 8.3308]]
							}
					}]
			},
			'islaDeLobos': {
					"type": "FeatureCollection",
					"features": [{
							"type": "Feature",
							"geometry": {
									"type": "LineString",
									"coordinates": [[-56.7412, -35.1945]]
							}
					}]
			},
			'salvador': 	{
					"type": "FeatureCollection",
					"features": [{
							"type": "Feature",
							"geometry": {
									"type": "LineString",
									"coordinates": [[-54.8834, -35.0267]]
							}
					}]
			},
			'capeVerde': 	{
					"type": "FeatureCollection",
					"features": [{
							"type": "Feature",
							"geometry": {
									"type": "LineString",
									"coordinates": [[-38.365938, -12.802113]]
							}
					}]
			},
			'southampton': {
					"type": "FeatureCollection",
					"features": [{
							"type": "Feature",
							"geometry": {
									"type": "LineString",
									"coordinates": [[-23.0418, 16.5388]]
							}
					}]
			}
	};
	var geojsonData = {
			'fuerteventura':	[[0.372266, 51.445877],
												[0.991001, 51.508742],
				                [1.386509, 51.522416],
				                [1.672153, 51.501904],
				                [1.880894, 51.330612],
				                [1.869907, 51.158677],
				                [1.485386, 50.944584],
				                [0.958042, 50.743408],
				                [0.441685, 50.541363],
				                [-0.173550, 50.694718],
				                [-0.623989, 50.520412],
				                [-1.283169, 50.380502],
				                [-2.195034, 50.429518],
				                [-2.854214, 50.162824],
				                [-3.656216, 49.944150],
				                [-4.414272, 49.823809],
				                [-5.282192, 49.774170],
				                [-5.963345, 49.944150],
				                [-5.974331, 50.429518],
				                [-5.326138, 50.889174],
				                [-4.590054, 50.986099],
				                [-4.436245, 51.082822],
				                [-4.787807, 51.206883],
				                [-5.556850, 50.999929],
				                [-6.205044, 50.798991],
				                [-6.589565, 50.422519],
				                [-7.171841, 49.823809],
				                [-7.182827, 49.425267],
				                [-7.158623, 48.777913],
				                [-6.916924, 48.297812],
				                [-7.268486, 47.620975],
				                [-7.945175, 46.860191],
				                [-7.769394, 45.859412],
				                [-7.681503, 45.305803],
				                [-8.384628, 44.809122],
				                [-9.263535, 44.056012],
												[-10.054550, 43.100983],
												[-10.450058, 42.488302],
												[-10.537949, 41.541478],
												[-10.933456, 41.046217],
												[-11.285019, 40.212441],
												[-11.241074, 38.856820],
												[-11.197128, 37.996163],
												[-11.021347, 37.195331],
												[-11.021347, 36.031332],
												[-10.933456, 35.101934],
												[-10.757675, 34.089061],
												[-10.450058, 33.247876],
												[-10.010605, 32.731841],
												[-9.267654, 32.026706],
												[-10.318222, 31.765537],
												[-10.977402, 31.353637],
												[-11.504745, 30.334954],
												[-11.988144, 29.535230],
												[-12.559433, 28.767659],
												[-13.866186, 28.484082]],
			'rioDeOro': 			[[-13.866186, 28.484082],
												[-14.060268, 28.004102],
												[-14.631557, 27.371767],
												[-14.895229, 27.039557],
												[-15.049038, 26.755421],
												[-15.125942, 26.450902],
												[-15.213833, 26.125850],
												[-15.257778, 25.839449],
												[-15.367641, 25.393661],
												[-15.444546, 24.996016],
												[-15.532436, 24.647017],
												[-15.675259, 24.307053],
												[-15.796667, 23.711389]],
			'sierraLeone': 		[[-15.796667, 23.711389],
												[-16.092739, 23.825551],
												[-16.598110, 23.543845],
												[-17.070522, 23.150462],
												[-18.013115, 22.492257],
												[-19.111748, 21.022983],
												[-19.573174, 19.808054],
												[-19.683037, 19.082884],
												[-19.770927, 16.678293],
												[-19.814873, 16.011389],
												[-19.858818, 15.707663],
												[-19.792900, 14.200488],
												[-19.639091, 12.597455],
												[-19.067802, 11.415418],
												[-17.969170, 9.968851],
												[-17.353935, 9.318990],
												[-16.475029, 8.646196],
												[-14.914970, 8.407168],
												[-13.0289, 8.3308]],
			'rioDeLaPlata': 	[[-13.0289, 8.3308],
												[-13.0289, 8.3308],
												[-12.989960, 6.140555],
												[-12.286835, 4.653080],
												[-12.550507, 1.933227],
												[-13.077850, 0.087891],
												[-13.253632, -1.318243],
												[-14.396210, -4.039618],
												[-15.802460, -6.053161],
												[-17.472382, -9.275622],
												[-19.405975, -12.125264],
												[-21.691132, -14.093957],
												[-24.415741, -16.299051],
												[-28.019257, -18.562947],
												[-31.534882, -20.715015],
												[-34.786835, -22.998852],
												[-39.445038, -24.607069],
												[-41.642303, -25.324167],
												[-44.191132, -25.403585],
												[-46.388397, -26.352498],
												[-47.355194, -27.916767],
												[-48.058319, -29.840644],
												[-49.113007, -30.826781],
												[-50.695038, -33.063924],
												[-53.155975, -35.173808],
												[-54.562225, -35.675147],
												[-55.762225, -35.575147],
												[-56.7412, -35.1945]],
			'islaDeLobos': 		[[-56.7412, -35.1945],
												[-56.126919, -35.071135],
												[-55.709438, -35.015915],
												[-55.313931, -35.108401],
												[-54.962368, -35.101934],
												[-54.8834, -35.0267]],
			'salvador': 			[[-54.8834, -35.0267],
												[-55.186386, -36.066862],
												[-55.494003, -36.597889],
												[-55.889511, -37.649034],
												[-56.988144, -38.719805],
												[-57.910995, -39.164141],
												[-58.921738, -39.740986],
												[-59.449081, -40.413496],
												[-60.591660, -40.647304],
												[-61.338730, -41.079351],
												[-62.261581, -41.738528],
												[-62.437363, -42.520700],
												[-61.119003, -42.908160],
												[-60.415878, -42.065607],
												[-59.185410, -41.079351],
												[-57.119980, -39.909736],
												[-54.351425, -38.203655],
												[-52.681503, -36.562600],
												[-48.946152, -33.504759],
												[-47.320175, -31.503629],
												[-46.133652, -29.840644],
												[-45.342636, -28.265682],
												[-44.244003, -27.137368],
												[-42.002792, -25.165173],
												[-40.904160, -23.402765],
												[-40.025253, -22.268764],
												[-39.453964, -20.509355],
												[-38.706894, -18.562947],
												[-38.355331, -16.804541],
												[-38.311386, -14.859850],
												[-38.443222, -13.539201],
												[-38.365938, -12.802113]],
			'capeVerde': 			[[-38.365938, -12.802113],
												[-38.197231, -13.239945],
												[-37.933559, -12.983148],
												[-37.735806, -12.768946],
												[-37.428188, -12.436577],
												[-36.988735, -12.178965],
												[-36.494350, -11.706031],
												[-35.967007, -11.307708],
												[-35.351772, -10.790141],
												[-34.912319, -10.260871],
												[-34.549770, -9.589917],
												[-34.395962, -8.939340],
												[-34.198208, -8.124491],
												[-34.132290, -7.329778],
												[-34.110317, -6.620957],
												[-34.220181, -5.769036],
												[-34.297085, -5.025283],
												[-34.582729, -4.182073],
												[-32.941132, -2.811371],
												[-30.831757, -0.527336],
												[-28.282928, 1.669686],
												[-26.085663, 3.688855],
												[-24.415741, 5.878332],
												[-23.809433, 7.493196],
												[-23.413925, 9.232249],
												[-23.106308, 11.307708],
												[-22.974472, 13.325485],
												[-23.145962, 14.306969],
												[-23.0418, 16.5388]],
			'southampton': 		[[-23.0418, 16.5388],
												[-22.842636, 17.769612],
												[-22.227402, 19.435514],
												[-22.051620, 21.207459],
												[-22.271347, 22.390714],
												[-22.578964, 24.006326],
												[-22.798691, 25.997550],
												[-22.974472, 27.839076],
												[-23.985214, 30.637912],
												[-24.117050, 32.472695],
												[-23.897324, 34.524661],
												[-22.798691, 36.774092],
												[-22.535019, 38.616870],
												[-20.900116, 40.044438],
												[-19.230194, 41.442726],
												[-17.648163, 42.617791],
												[-15.802460, 43.771094],
												[-13.868866, 45.151053],
												[-11.759491, 46.498392],
												[-9.650116, 47.813155],
												[-8.068085, 48.516604],
												[-6.222382, 49.095452],
												[-4.200897, 49.724479],
												[-2.530975, 50.176898],
												[-1.4044, 50.9097]]
	};

	var chapters = {
    	'departure': {
          duration: 5000,
          bearing: 0,
          center: [-39.971008, 19.642588],
          zoom: 2,
          pitch: 0
      },
      'england': {
          duration: 6000,
          bearing: 5,
          center: [-0.14955, 51.4775],
          zoom: 4,
          pitch: 10
      },
      'toFuerteventura': {
          duration: 4000,
          center: [-24.0537, 28.3587],
          bearing: -0,
          zoom: 4,
          pitch: 30
      },
      'fuerteventura': {
          duration: 7500,
          center: [-14.0537, 28.3587],
          bearing: 0,
          zoom: 4.15,
          pitch: 20
      },
      'toRioDeOro': {
          duration: 6000,
          center: [-15.796667, 23.711389],
          bearing: -0,
          zoom: 4,
          pitch: 40
      },
      'rioDeOro': {
          duration: 6000,
          center: [-15.796667, 23.711389],
          bearing: -5,
          zoom: 4.25,
          pitch: 10
      },
      'toSierraLeone': {
          duration: 6000,
          center: [-13.0289, 8.3308],
          bearing: 0,
          zoom: 4,
          pitch: 40
      },
      'sierraLeone': {
          duration: 5000,
          center: [-13.0289, 8.3308],
          bearing: 0,
          zoom: 4,
          pitch: 40
      },
      'toRioDeLaPlata': {
          duration: 12000,
          bearing: 0,
          center: [-56.7412, -35.1945],
          zoom: 4,
          pitch: 40
      },
      'rioDeLaPlata': {
          duration: 5000,
          bearing: 20,
          center: [-56.7412, -35.1945],
          zoom: 2.5,
          pitch: 10
      },
      'toIslaDeLobos': {
          bearing: 0,
          center: [-54.8834, -35.0267],
          zoom: 4,
          duration: 5000,
          pitch: 40
      },
      'islaDeLobos': {
          bearing: 0,
          center: [-54.8834, -35.0267],
          zoom: 4,
          duration: 5000,
          pitch: 40
      },
      'toSalvador': {
          bearing: 0,
          center: [-38.365938, -12.802113],
          zoom: 4,
          duration: 10000,
          pitch: 40
      },
      'salvador': {
          bearing: 10,
          center: [-38.365938, -12.802113],
          zoom: 3,
          duration: 10000,
          pitch: 20
      },
      'toCapeVerde': {
          bearing: 0,
          center: [-23.0418, 16.5388],
          zoom: 4,
          duration: 10000,
          pitch: 40
      },
      'capeVerde': {
          bearing: 0,
          center: [-23.0418, 16.5388],
          zoom: 4,
          duration: 10000,
          pitch: 40
      },
      'toSouthampton': {
          bearing: 0,
          center: [-1.4044, 50.9097],
          zoom: 4,
          duration: 8000,
          pitch: 40
      },
      'southampton': {
          bearing: 0,
          center: [-39.971008, 0.642588],
          zoom: 1.8,
          duration: 8000,
          pitch: 0
  		}
		};
		var isMapLoaded = false;
		var animation; // to store and cancel the animation
		var chapterNames = Object.keys(chapters);
		var chapterName;
		var activeChapterNumber;
		var element;
		var bounds;
		var frame = [];
		var lineDrawn = [];
		var inProgress = [];
		for (var i = 0; i < chapterNames.length; i++) {
			frame[i] = 0;
			lineDrawn[i] = false;
			inProgress[i] = false;
		}

		var lineIdRef = ['','','','lineToFuerteventura','','lineToRioDeOro','','lineToSierraLeone','','lineToRioDeLaPlata','','lineToIslaDeLobos','','lineToSalvador','','lineToCapeVerde','','lineToSouthampton'];
		var activeChapterName = 'england';
		function setActiveChapter(chapterName) {
				if (chapterName === activeChapterName) return;
				map.easeTo(chapters[chapterName]);
				document.getElementById(chapterName).setAttribute('class', 'active');
				document.getElementById(activeChapterName).setAttribute('class', '');
				activeChapterName = chapterName;
				if (startTrip[chapterName] && isMapLoaded) {
					startTrip[chapterName]();
				}
		}
		// Checks to see if element is within the viewport
		function isElementOnScreen(id) {
				element = document.getElementById(id);
				bounds = element.getBoundingClientRect();
				return bounds.top < window.innerHeight && bounds.bottom > 0;
		}

		// 'fuerteventura': function() {
		// 		if (lineDrawn[3]) {
		// 				geojsonLine['fuerteventura'].features[0].geometry.coordinates = [geojsonData['fuerteventura'][0]];
		// 				map.getSource('lineToFuerteventura').setData(geojsonLine['fuerteventura']);
		// 				lineDrawn[3] = false;
		// 		} else if (){
		// 				frame[3] = 0;
		// 				incrementLine();
		// 				lineDrawn[3] = true;
		// 		}
    //
		// 		function incrementLine() {
		// 				if (frame[3] <= geojsonData['fuerteventura'].length - 1 && !lineDrawn[3]) {
		// 						setTimeout(function() {
		// 								geojsonLine['fuerteventura'].features[0].geometry.coordinates.push(geojsonData['fuerteventura'][frame[3]]);
		// 								console.log('Frame #' + frame[3] + ': Added ' + geojsonData['fuerteventura'][frame[3]] + ' to line fuerteventura ', map.getSource('lineToFuerteventura'));
		// 								map.getSource('lineToFuerteventura').setData(geojsonLine['fuerteventura']);
		// 								frame[3]++;
		// 								console.log(lineDrawn[3]);
		// 								animation = requestAnimationFrame(incrementLine);
		// 						}, 30);
		// 				}
		// 		}

		var startTrip = {
				'fuerteventura': function() {
						inProgress[3] = true;
						if (frame[3] <= geojsonData['fuerteventura'].length - 1 && !lineDrawn[3]) {
								setTimeout(function() {
										geojsonLine['fuerteventura'].features[0].geometry.coordinates.push(geojsonData['fuerteventura'][frame[3]]);
										// console.log('Frame #' + frame[3] + ': Added ' + geojsonData['fuerteventura'][frame[3]] + ' to line fuerteventura ', map.getSource('lineToFuerteventura'));
										map.getSource('lineToFuerteventura').setData(geojsonLine['fuerteventura']);
										frame[3]++;
										animation = requestAnimationFrame(startTrip['fuerteventura']);
								}, 30);
						} else {
								frame[3] = 0;
								lineDrawn[3] = true;
								inProgress[3] = false;
								reloadTrips();
						}
				},
				'rioDeOro': function() {
						inProgress[5] = true;
						if (frame[5] <= geojsonData['rioDeOro'].length - 1 && !lineDrawn[5]) {
								setTimeout(function() {
										geojsonLine['rioDeOro'].features[0].geometry.coordinates.push(geojsonData['rioDeOro'][frame[5]]);
										// console.log('Frame #' + frame[5] + ': Added ' + geojsonData['rioDeOro'][frame[5]] + ' to line rioDeOro ', map.getSource('lineToRioDeOro'));
										map.getSource('lineToRioDeOro').setData(geojsonLine['rioDeOro']);
										frame[5]++;
										animation = requestAnimationFrame(startTrip['rioDeOro']);
								}, 30);
						} else {
								frame[5] = 0;
								lineDrawn[5] = true;
								inProgress[5] = false;
								reloadTrips();
						}
				},
				'sierraLeone': function() {
						inProgress[7] = true;
						if (frame[7] <= geojsonData['sierraLeone'].length - 1 && !lineDrawn[7]) {
								setTimeout(function() {
										geojsonLine['sierraLeone'].features[0].geometry.coordinates.push(geojsonData['sierraLeone'][frame[7]]);
										// console.log('Frame #' + frame[7] + ': Added ' + geojsonData['sierraLeone'][frame[7]] + ' to line sierraLeone ', map.getSource('lineToSierraLeone'));
										map.getSource('lineToSierraLeone').setData(geojsonLine['sierraLeone']);
										frame[7]++;
										animation = requestAnimationFrame(startTrip['sierraLeone']);
								}, 30);
						} else {
								frame[7] = 0;
								lineDrawn[7] = true;
								inProgress[7] = false;
								reloadTrips();
						}
				},
				'rioDeLaPlata': function() {
						inProgress[9] = true;
						if (frame[9] <= geojsonData['rioDeLaPlata'].length - 1 && !lineDrawn[9]) {
								setTimeout(function() {
										geojsonLine['rioDeLaPlata'].features[0].geometry.coordinates.push(geojsonData['rioDeLaPlata'][frame[9]]);
										// console.log('Frame #' + frame[9] + ': Added ' + geojsonData['rioDeLaPlata'][frame[9]] + ' to line rioDeLaPlata ', map.getSource('lineToRioDeLaPlata'));
										map.getSource('lineToRioDeLaPlata').setData(geojsonLine['rioDeLaPlata']);
										frame[9]++;
										animation = requestAnimationFrame(startTrip['rioDeLaPlata']);
								}, 40);
						} else {
								frame[9] = 0;
								lineDrawn[9] = true;
								inProgress[9] = false;
								reloadTrips();
						}
				},
				'islaDeLobos': function() {
						inProgress[11] = true;
						if (frame[11] <= geojsonData['islaDeLobos'].length - 1 && !lineDrawn[11]) {
								setTimeout(function() {
										geojsonLine['islaDeLobos'].features[0].geometry.coordinates.push(geojsonData['islaDeLobos'][frame[11]]);
										// console.log('Frame #' + frame[11] + ': Added ' + geojsonData['islaDeLobos'][frame[11]] + ' to line islaDeLobos ', map.getSource('lineToIslaDeLobos'));
										map.getSource('lineToIslaDeLobos').setData(geojsonLine['islaDeLobos']);
										frame[11]++;
										animation = requestAnimationFrame(startTrip['islaDeLobos']);
								}, 30);
						} else {
								frame[11] = 0;
								lineDrawn[11] = true;
								inProgress[11] = false;
								reloadTrips();
						}
				},
				'salvador': function() {
						inProgress[13] = true;
						if (frame[13] <= geojsonData['salvador'].length - 1 && !lineDrawn[13]) {
								setTimeout(function() {
										geojsonLine['salvador'].features[0].geometry.coordinates.push(geojsonData['salvador'][frame[13]]);
										// console.log('Frame #' + frame[13] + ': Added ' + geojsonData['salvador'][frame[13]] + ' to line salvador ', map.getSource('lineToSalvador'));
										map.getSource('lineToSalvador').setData(geojsonLine['salvador']);
										frame[13]++;
										animation = requestAnimationFrame(startTrip['salvador']);
								}, 30);
						} else {
								frame[13] = 0;
								lineDrawn[13] = true;
								inProgress[13] = false;
								reloadTrips();
						}
				},
				'capeVerde': function() {
						inProgress[15] = true;
						if (frame[15] <= geojsonData['capeVerde'].length - 1 && !lineDrawn[15]) {
								setTimeout(function() {
										geojsonLine['capeVerde'].features[0].geometry.coordinates.push(geojsonData['capeVerde'][frame[15]]);
										// console.log('Frame #' + frame[15] + ': Added ' + geojsonData['capeVerde'][frame[15]] + ' to line capeVerde ', map.getSource('lineToCapeVerde'));
										map.getSource('lineToCapeVerde').setData(geojsonLine['capeVerde']);
										frame[15]++;
										animation = requestAnimationFrame(startTrip['capeVerde']);
								}, 30);
						} else {
								frame[15] = 0;
								lineDrawn[15] = true;
								inProgress[15] = false;
								reloadTrips();
						}
				},
				'southampton': function() {
						inProgress[17] = true;
						if (frame[17] <= geojsonData['southampton'].length - 1 && !lineDrawn[17]) {
								setTimeout(function() {
										geojsonLine['southampton'].features[0].geometry.coordinates.push(geojsonData['southampton'][frame[17]]);
										// console.log('Frame #' + frame[17] + ': Added ' + geojsonData['southampton'][frame[17]] + ' to line southampton ', map.getSource('lineToSouthampton'));
										map.getSource('lineToSouthampton').setData(geojsonLine['southampton']);
										frame[17]++;
										animation = requestAnimationFrame(startTrip['southampton']);
								}, 30);
						} else {
								frame[17] = 0;
								lineDrawn[17] = true;
								inProgress[17] = false;
								reloadTrips();
						}
				}
		};
		// Get textboxes
		map.on('load', function() {
		    map.addLayer({
		        'id': 'lineToFuerteventura',
		        'type': 'line',
		        'source': {
		            'type': 'geojson',
		            'data': geojsonLine['fuerteventura']
		        },
		        'layout': {
		            'line-cap': 'round',
		            'line-join': 'round',
		        },
		        'paint': {
		            'line-color': '#9A0000',
		            'line-width': 5,
		            'line-opacity': 0.9,
		            'line-dasharray': [1, 2],
		            'line-blur': 1
		        }
		    });
				map.addLayer({
		        'id': 'lineToRioDeOro',
		        'type': 'line',
		        'source': {
		            'type': 'geojson',
		            'data': geojsonLine['rioDeOro']
		        },
		        'layout': {
		            'line-cap': 'round',
		            'line-join': 'round',
		        },
		        'paint': {
		            'line-color': '#9A0000',
		            'line-width': 5,
		            'line-opacity': 0.9,
		            'line-dasharray': [1, 2],
		            'line-blur': 1
		        }
		    });
				map.addLayer({
		        'id': 'lineToSierraLeone',
		        'type': 'line',
		        'source': {
		            'type': 'geojson',
		            'data': geojsonLine['sierraLeone']
		        },
		        'layout': {
		            'line-cap': 'round',
		            'line-join': 'round',
		        },
		        'paint': {
		            'line-color': '#9A0000',
		            'line-width': 5,
		            'line-opacity': 0.9,
		            'line-dasharray': [1, 2],
		            'line-blur': 1
		        }
		    });
				map.addLayer({
		        'id': 'lineToRioDeLaPlata',
		        'type': 'line',
		        'source': {
		            'type': 'geojson',
		            'data': geojsonLine['rioDeLaPlata']
		        },
		        'layout': {
		            'line-cap': 'round',
		            'line-join': 'round',
		        },
		        'paint': {
		            'line-color': '#9A0000',
		            'line-width': 5,
		            'line-opacity': 0.9,
		            'line-dasharray': [1, 2],
		            'line-blur': 1
		        }
		    });
				map.addLayer({
		        'id': 'lineToIslaDeLobos',
		        'type': 'line',
		        'source': {
		            'type': 'geojson',
		            'data': geojsonLine['islaDeLobos']
		        },
		        'layout': {
		            'line-cap': 'round',
		            'line-join': 'round',
		        },
		        'paint': {
		            'line-color': '#9A0000',
		            'line-width': 5,
		            'line-opacity': 0.9,
		            'line-dasharray': [1, 2],
		            'line-blur': 1
		        }
		    });
				map.addLayer({
		        'id': 'lineToSalvador',
		        'type': 'line',
		        'source': {
		            'type': 'geojson',
		            'data': geojsonLine['salvador']
		        },
		        'layout': {
		            'line-cap': 'round',
		            'line-join': 'round',
		        },
		        'paint': {
		            'line-color': '#9A0000',
		            'line-width': 5,
		            'line-opacity': 0.9,
		            'line-dasharray': [1, 2],
		            'line-blur': 1
		        }
		    });
				map.addLayer({
		        'id': 'lineToCapeVerde',
		        'type': 'line',
		        'source': {
		            'type': 'geojson',
		            'data': geojsonLine['capeVerde']
		        },
		        'layout': {
		            'line-cap': 'round',
		            'line-join': 'round',
		        },
		        'paint': {
		            'line-color': '#9A0000',
		            'line-width': 5,
		            'line-opacity': 0.9,
		            'line-dasharray': [1, 2],
		            'line-blur': 1
		        }
		    });
				map.addLayer({
		        'id': 'lineToSouthampton',
		        'type': 'line',
		        'source': {
		            'type': 'geojson',
		            'data': geojsonLine['southampton']
		        },
		        'layout': {
		            'line-cap': 'round',
		            'line-join': 'round',
		        },
		        'paint': {
		            'line-color': '#9A0000',
		            'line-width': 5,
		            'line-opacity': 0.9,
		            'line-dasharray': [1, 2],
		            'line-blur': 1
						}
		    });

				// Allows global functions to run
				isMapLoaded = true;

				if (activeChapterName !== 'departure' && activeChapterName !== 'england') {
					reloadTrips();
				} else {
					console.log('reloadTrips() not called');
				}

				function onReady(callback) {
				    var intervalID = window.setInterval(checkReady, 1000);

				    function checkReady() {
				        if (document.getElementsByTagName('body')[0] !== undefined) {
				            window.clearInterval(intervalID);
				            callback.call(this);
				        }
				    }
				}

				function show(id, value) {
				    document.getElementById(id).style.opacity = value ? 1 : 0;
				}

				onReady(function () {
				    show('content', true);
				    show('loading', false);
				});

		});

function reloadTrips(chN) {
		if (isMapLoaded) {
				// Find the number of the chapter which the user has refreshed on
				if (chN) {
						activeChapterNumber = chN;
				} else {
						activeChapterNumber = chapterNames.indexOf(activeChapterName);
				}
				// If it is an intermediary chapter, switch to real chapter
				if (!isOdd(activeChapterNumber)) {
						activeChapterNumber++;
				}
				var selectedChapter;
				// Increments backwards through stops and draws lines
				for (var i = 3; i < chapterNames.length; i+=2) {
						selectedChapter = chapterNames[i];
						if (i <= activeChapterNumber && !lineDrawn[i] && !inProgress[i]) {
								geojsonLine[selectedChapter].features[0].geometry.coordinates = geojsonData[selectedChapter];
								lineDrawn[i] = true;
								console.log(selectedChapter + ' ' + i + ' automatically populated');
						} else if (i > activeChapterNumber && lineDrawn[i] === true) {
								geojsonLine[selectedChapter].features[0].geometry.coordinates = [geojsonData[selectedChapter][0]];
								lineDrawn[i] = false;
								console.log(selectedChapter + ' ' + i + ' automatically erased');
						}
						map.getSource(lineIdRef[i]).setData(geojsonLine[selectedChapter]);
				}
		}
}

function isOdd(num) { return num % 2; }

</script>
</body>
</html>
